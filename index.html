<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title></title><meta name="author" content="Legacy"><meta name="copyright" content="Legacy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="冒险的生涯在召唤！">
<meta property="og:type" content="website">
<meta property="og:title">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name">
<meta property="og:description" content="冒险的生涯在召唤！">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/avatar.png">
<meta property="article:author" content="Legacy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-07-23 01:12:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">46</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 爱好收集</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/index.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/"></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 爱好收集</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title"></h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/466764255/" title="airflow整理"><img class="post_bg" src="https://wei-foun.github.io/img/cover47.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="airflow整理"></a></div><div class="recent-post-info"><a class="article-title" href="/466764255/" title="airflow整理">airflow整理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-12T07:04:30.000Z" title="发表于 2025-07-12 15:04:30">2025-07-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/airflow/">airflow</a></span></div><div class="content">组件介绍
WebServer：提供交互界面和监控，让开发者调试和监控所有 Task 的运行
Scheduler：负责解析和调度 Task 任务提交到 Execution 中运行
Executor：执行组件，负责运行 Scheduler 分配的 Task，运行在 Worker
MetaData DataBase：AirFlow 的元数据存储数据库，记录所有 DAG 程序的信息

相关概念
dag：有向无环图，airflow 中有三种任务的定义来描述一个系任务，分别是 operators，sensors，taskflow 装饰器，taskflow 本质上也是 operator，他们都基于 baseoperator，可以将 Operator 理解为一个任务单元
dagrun：dag 的运行实例，由解析程序解析 dag 的 starttime、endtime、schedule_interval 等，根据定时时间生成 dagrun
task instance：是 dagrun 中每个 task 的运行实例，每个任务都有一个状态的生命周期。task 的运行将根据 dag 中定义的依赖关系去判断执行 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2133446919/" title="Linux再学习"><img class="post_bg" src="https://wei-foun.github.io/img/cover46.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux再学习"></a></div><div class="recent-post-info"><a class="article-title" href="/2133446919/" title="Linux再学习">Linux再学习</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-12T06:58:04.000Z" title="发表于 2025-07-12 14:58:04">2025-07-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/linux-%E5%9F%BA%E7%A1%80/">linux 基础</a></span></div><div class="content">Terminal终端可以分为：tty，pts
Tty（Teletype）传统物理终端的抽象，可以分物理 tty，虚拟 tty（/dev/tty1~/dev/tty6），一般本地登录都是使用 tty 
Pts （Pseudo Terminal Slave）伪终端，最常见的比如 ssh 远程连接，pts 是动态创建，如 /dev/pts/0
通过输入 tty 命令，可以查看当前是哪个终端
12root@LostStars:~# tty/dev/pts/0
包管理常见的 linux 包管理系统有 redhat 的 rpm（包后缀是 .rpm），debian 的 dpkg（包后缀是 .deb）
使用 rpm 安装安装 rpm 包，rpm -i xxxx.rpm，注意使用 rpm 命令安装 rpm 包时无法处理有依赖关系的包
所以就有了 yum/dnf（centos） 和 apt（ubuntu）这种高级的包管理工具，他们可以在安装包的时候自动处理相关的依赖包安装。补充：dnf 是 yum 的继任者，在处理性能上高于 yum
yum/dnf 属于 C/S 架构，yum 服务器存放着 rpm 包和相 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/4075015966/" title="GO 基础"><img class="post_bg" src="https://wei-foun.github.io/img/cover45.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GO 基础"></a></div><div class="recent-post-info"><a class="article-title" href="/4075015966/" title="GO 基础">GO 基础</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-04T16:26:58.000Z" title="发表于 2025-07-05 00:26:58">2025-07-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/go-%E8%AF%AD%E6%B3%95/">go 语法</a></span></div><div class="content">基础整理初始化和依赖管理创建 go 项目目录后，进入目录用go mod init 命令初始化项目生成一个 go.mod 文件
1234567891011121314151617$ go mod init mygin$ cat go.modmodule mygingo 1.20require (  github.com/gin-gonic/gin v1.9.1  k8s.io/apimachinery v0.25.2  k8s.io/client-go v0.25.2)require (  github.com/PuerkitoBio/purell v1.1.1 // indirect  ....)
当项目中要使用到第三方库，可以用 go get 去下载安装，然后就可以在文件中导入。同时目录下的 go.mod 和 go.sum 文件会有对应的修改

go.mod 文件列出了项目的模块名和它直接依赖的模块及其版本
go.sum 文件包含了所有依赖包的校验和，用于确保下载的包没有被篡改

12345678go get github.com/gin-gonic/gin————————————— ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/4209932858/" title="docker 容器网络"><img class="post_bg" src="https://wei-foun.github.io/img/cover44.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="docker 容器网络"></a></div><div class="recent-post-info"><a class="article-title" href="/4209932858/" title="docker 容器网络">docker 容器网络</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-04T16:26:58.000Z" title="发表于 2023-07-05 00:26:58">2023-07-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/container-network/">container network</a></span></div><div class="content">容器网络基本概述​    对于 linux 容器来说它的网络栈实际是被一个 network namespace 所包住的，通过名称空间实现和宿主机的网络栈隔离，其中包括网卡，回环设备，路由表和 iptables 规则
​    不过也可以使用 -net=host 的参数启动容器，这样这个容器就会直接使用宿主机的网络栈，容器内监听的端口就成了宿主机的实际端口
​    这种方式虽然提供很好的网络性能，但容易出现端口冲突（宿主机端口永远是最稀缺的资源）
​    因此常用的网络模式是利用网桥作为虚拟交换机来实现多容器间通信，因此如果使用宿主机网络栈，那么就必须提前规划好容器使用端口
​    对于一个容器来说，它和宿主机之间通过一个虚拟设备 Veth Pair 进行连接，其中一端插在容器内部网络栈的网卡上（eth0），另一端则是在宿主机上（vethxxxx），所以 Veth Pair 可以将宿主机的 host namespace 与容器的 network namespace 连接
123(.venv) ➜  cdosapi-vm brctl showbridge name     brid ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/4253636491/" title="kubernetes-搭建"><img class="post_bg" src="https://wei-foun.github.io/img/cover43.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="kubernetes-搭建"></a></div><div class="recent-post-info"><a class="article-title" href="/4253636491/" title="kubernetes-搭建">kubernetes-搭建</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-19T10:39:02.000Z" title="发表于 2023-03-19 18:39:02">2023-03-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kuberbetes/">kuberbetes</a></span></div><div class="content">Kubernetes 搭建虚拟机​    虚拟机选择的是 virtualBox，原因是轻量化，以学习和测试为目的的话比较适合。以一个最容易的 k8s 服务集群搭建来说，需要创建至少两个虚拟机，分别代表 master 和 node
网络设置​        virtualBox 中创建好 ubuntu 虚拟机后，默认的网络模式是 NAT 网络地址转换模式，注意这里有一个问题，创建好两台虚拟机后，使用 ifconfig 查看网络信息，会发现两个虚拟机的 ip 是一致的，这会导致 node 想要通过 join 加入到 master 时连接会被拒绝
​        所以，在 virtualBox 的虚拟机设置中，网卡设置需要从 网络地址转换（NAT）换成 NAT 网络，因为 virtualBox 软件的全局设置中网卡标签栏中是 NAT Networks，并且可以在全局网卡的 NAT 配置栏里看到默认设置 ip 网络段
​        另外，如果想要通过 ssh 方式让主机终端连接虚拟机，在虚拟机的网卡设置中还需要另外加上一个网卡，模式选择 host-only。同时主机终端通过 ssh 连接 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/undefined/" title="wsl docker 卸载"><img class="post_bg" src="https://wei-foun.github.io/img/cover42.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="wsl docker 卸载"></a></div><div class="recent-post-info"><a class="article-title" href="/undefined/" title="wsl docker 卸载">wsl docker 卸载</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-05T08:50:50.000Z" title="发表于 2023-03-05 16:50:50">2023-03-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/docker/">docker</a></span></div><div class="content">WSL 中卸载 docker 的问题​    在使用 apt remove docker-ce 时最后返回了下面的错误信息
1E: Sub-process /usr/bin/dpkg returned an error code (1)
​    在了解过后，说是 docker 这个服务因为已经停止或没有使用，所以无法卸载。于是看到解决办法中需要修改 docker-ce.prerm 文件
123if ([ -x &quot;/etc/init.d/docker&quot; ] || [ -e &quot;/etc/init/docker.conf&quot; ]) &amp;&amp; \   [ &quot;$1&quot; = remove ]; then invoke-rc.d docker stop || exit $?fi
​    将其修改如下即可
123if ([ -x &quot;/etc/init.d/docker&quot; ] || [ -e &quot;/etc/init/docker.conf&quot; ]) &amp;&amp; \   [ &quot;$ ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2970976912/" title="日积跬步"><img class="post_bg" src="https://wei-foun.github.io/img/cover24.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="日积跬步"></a></div><div class="recent-post-info"><a class="article-title" href="/2970976912/" title="日积跬步">日积跬步</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-27T06:45:15.000Z" title="发表于 2023-01-27 14:45:15">2023-01-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/debug/">debug</a></span></div><div class="content">Flask 蓝图，应用注册问题1AttributeError: module &#x27;apps.app01.views.user&#x27; has no attribute &#x27;name&#x27;
​    按照教程一步步做的，虽然有些改动，但是去启动的时候总是抛出没有 “name” 属性的异常，后来发现模块导入时没有直接导入蓝图注册的对象
123456789101112from flask import Flaskfrom .views import user,bookapps = Flask(__name__)def create_app():    apps.register_blueprint(blueprint=user)	# views 文件中创建了蓝图对象 user = Blueprint(&quot;user&quot;, __name__)，但是在文件导入时，只是导入 views 下的 user 模块，然后蓝图注册的 blueprint 参数这里写的模块，所以一直抛出没有 name 属性        apps.register_blueprint(b ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/1772758044/" title="关于MySQL的一些问题"><img class="post_bg" src="https://wei-foun.github.io/img/cover41.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="关于MySQL的一些问题"></a></div><div class="recent-post-info"><a class="article-title" href="/1772758044/" title="关于MySQL的一些问题">关于MySQL的一些问题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-11-26T03:17:32.000Z" title="发表于 2022-11-26 11:17:32">2022-11-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/mysql-%E6%95%B4%E7%90%86/">mysql 整理</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/mysql-%E6%95%B4%E7%90%86/mysql-%E6%A0%B8%E5%BF%83/">mysql 核心</a></span></div><div class="content">全索引扫描的情况对条件字段使用函数操作​    在 mysql 中定义了很多函数可供使用，例如 month(), year(), convert(), format() 等等，但在查询时，如果对字段使用了函数操作，那么将无法使用索引来加速
​    例如现有一张交易日志表，存储了 2016 - 2018 年每天的数据记录，约 10 万条记录，具体表结构如下：
123456789CREATE TABLE `tradelog` (  `id` int(11) NOT NULL,  `tradeid` varchar(32) DEFAULT NULL,  `operator` int(11) DEFAULT NULL,  `t_modified` datetime DEFAULT NULL,  PRIMARY KEY (`id`),  KEY `tradeid` (`tradeid`),  KEY `t_modified` (`t_modified`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
​    现在查询条件是根据 t_modified 字段查询 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/311488900/" title="redis-消息队列"><img class="post_bg" src="https://wei-foun.github.io/img/cover40.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="redis-消息队列"></a></div><div class="recent-post-info"><a class="article-title" href="/311488900/" title="redis-消息队列">redis-消息队列</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-11-21T09:56:38.000Z" title="发表于 2022-11-21 17:56:38">2022-11-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/redis-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">redis-消息队列</a></span></div><div class="content">消息队列​    消息队列是生产消费者模型中最关键的一个部分，它需要接受来自生产者发送的消息，并进行短暂的存储，然后对于消息的消费者可以异步来获取消息
​    由此，消息队列应该需要满足以下三个需求：
​    首先，对于消息的存储应该是有序的，应该是先进先出，如果消息不是有序存储，消费者在异步获取时，假如有两个消息都是对库存修改，但是修改值不同，如果直接存储更新后的结果，那么在获取时，在后一个消息被先处理的情况下，库存值显然是错误的。对此，可以换一种方式，将扣除的值作为消息存储，消费者无论先处理哪个，最后计算的库存值都是正确的，但是这有一个前提，就是在中间没有读取库存的情况下，如果中间操作时有读取操作，计算的数值还是错误的
​    其次，消息队列要避免消息的重复消费，如果一个消息被重复消费进行处理，显然是错误的，一种避免重复消费的方法，是通过给消息设置一个唯一的 id 作为标识
​    最后，消息队列要保证消息可靠性，因为消费者在处理时可能出现错误而退出，应该要允许消费者重新获取该消息再次处理，否者造成消息丢失，一样会对业务造成错误影响
redis 的队列实现​    redi ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/306062435/" title="Nodejs-整理"><img class="post_bg" src="https://wei-foun.github.io/img/cover39.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nodejs-整理"></a></div><div class="recent-post-info"><a class="article-title" href="/306062435/" title="Nodejs-整理">Nodejs-整理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-11-08T14:41:23.000Z" title="发表于 2022-11-08 22:41:23">2022-11-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/nodejs/">nodejs</a></span></div><div class="content">设计架构​    nodejs 整体上设计架构和 chrome 浏览器很相似，chrome 强大的性能源自于 V8 引擎，nodejs 也同样继承了这一点，摆脱了 chrome 中 UI 部分的组件，例如 webkit，显卡，html 等，这使得 js 可以脱离浏览器来执行，从而实现了 nodejs 可以开发后端程序

​    nodejs 保留了前端中 js 的那些 api，没有更改任何语言的特性，nodejs 是基于 单线程 的 异步IO 架构
​    首先，单线程带来的优势是无需时刻注意状态同步问题，避免了死锁产生，减少了线程切换带来的性能开销。但有利就有弊，单线程的模式无法利用到多核 CPU，程序可能因为一个小错误就直接结束退出，另一个问题就是如果涉及到大量 CPU 密集操作可能会影响 异步IO 的调用
​    为了解决可能的 CPU 密集操作对 nodejs 中异步IO 造成性能影响，nodejs 可以使用  child_process 利用子进程来将计算性的任务分解，通过进程的事件消息来传输结果，这样一来可以有效提升健壮性
​    然后，是异步IO，在 node 中 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/#content-inner">5</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Legacy</div><div class="author-info__description">冒险的生涯在召唤！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">46</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Live a life you will remember</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/466764255/" title="airflow整理"><img src="https://wei-foun.github.io/img/cover47.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="airflow整理"/></a><div class="content"><a class="title" href="/466764255/" title="airflow整理">airflow整理</a><time datetime="2025-07-12T07:04:30.000Z" title="发表于 2025-07-12 15:04:30">2025-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2133446919/" title="Linux再学习"><img src="https://wei-foun.github.io/img/cover46.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux再学习"/></a><div class="content"><a class="title" href="/2133446919/" title="Linux再学习">Linux再学习</a><time datetime="2025-07-12T06:58:04.000Z" title="发表于 2025-07-12 14:58:04">2025-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/4075015966/" title="GO 基础"><img src="https://wei-foun.github.io/img/cover45.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GO 基础"/></a><div class="content"><a class="title" href="/4075015966/" title="GO 基础">GO 基础</a><time datetime="2025-07-04T16:26:58.000Z" title="发表于 2025-07-05 00:26:58">2025-07-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/4209932858/" title="docker 容器网络"><img src="https://wei-foun.github.io/img/cover44.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="docker 容器网络"/></a><div class="content"><a class="title" href="/4209932858/" title="docker 容器网络">docker 容器网络</a><time datetime="2023-07-04T16:26:58.000Z" title="发表于 2023-07-05 00:26:58">2023-07-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/4253636491/" title="kubernetes-搭建"><img src="https://wei-foun.github.io/img/cover43.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="kubernetes-搭建"/></a><div class="content"><a class="title" href="/4253636491/" title="kubernetes-搭建">kubernetes-搭建</a><time datetime="2023-03-19T10:39:02.000Z" title="发表于 2023-03-19 18:39:02">2023-03-19</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Elasticsearch-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/"><span class="card-category-list-name">Elasticsearch 基本概念</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python-%E8%AF%AD%E6%B3%95/"><span class="card-category-list-name">Python 语法</span><span class="card-category-list-count">8</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python-%E8%AF%AD%E6%B3%95/Python-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/"><span class="card-category-list-name">Python 深入理解</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python-%E8%AF%AD%E6%B3%95/py-2-%E5%92%8C-3-%E7%9A%84%E5%8C%BA%E5%88%AB/"><span class="card-category-list-name">py 2 和 3 的区别</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python-%E8%AF%AD%E6%B3%95/%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/"><span class="card-category-list-name">常用模块</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python-%E8%AF%AD%E6%B3%95/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="card-category-list-name">并发编程</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python-%E8%AF%AD%E6%B3%95/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/"><span class="card-category-list-name">网络编程</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/WSGI-%E6%9C%8D%E5%8A%A1%E5%99%A8/"><span class="card-category-list-name">WSGI 服务器</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Django/" style="font-size: 1.2em; color: #999da3">Django</a> <a href="/tags/ES6/" style="font-size: 1.1em; color: #999">ES6</a> <a href="/tags/Elasticsearch/" style="font-size: 1.1em; color: #999">Elasticsearch</a> <a href="/tags/JavaScript/" style="font-size: 1.4em; color: #99a5b6">JavaScript</a> <a href="/tags/Rest-Framework/" style="font-size: 1.1em; color: #999">Rest_Framework</a> <a href="/tags/airflow/" style="font-size: 1.1em; color: #999">airflow</a> <a href="/tags/appium/" style="font-size: 1.1em; color: #999">appium</a> <a href="/tags/celery/" style="font-size: 1.1em; color: #999">celery</a> <a href="/tags/docker/" style="font-size: 1.2em; color: #999da3">docker</a> <a href="/tags/git/" style="font-size: 1.1em; color: #999">git</a> <a href="/tags/golang/" style="font-size: 1.1em; color: #999">golang</a> <a href="/tags/kuberbetes/" style="font-size: 1.1em; color: #999">kuberbetes</a> <a href="/tags/leetcode/" style="font-size: 1.1em; color: #999">leetcode</a> <a href="/tags/linux/" style="font-size: 1.1em; color: #999">linux</a> <a href="/tags/mysql/" style="font-size: 1.4em; color: #99a5b6">mysql</a> <a href="/tags/nginx/" style="font-size: 1.1em; color: #999">nginx</a> <a href="/tags/nodejs/" style="font-size: 1.1em; color: #999">nodejs</a> <a href="/tags/pyquery/" style="font-size: 1.1em; color: #999">pyquery</a> <a href="/tags/python/" style="font-size: 1.5em; color: #99a9bf">python</a> <a href="/tags/redis/" style="font-size: 1.3em; color: #99a1ac">redis</a> <a href="/tags/scrapy/" style="font-size: 1.2em; color: #999da3">scrapy</a> <a href="/tags/selenium/" style="font-size: 1.2em; color: #999da3">selenium</a> <a href="/tags/tcpdump/" style="font-size: 1.1em; color: #999">tcpdump</a> <a href="/tags/web-%E5%AE%89%E5%85%A8/" style="font-size: 1.1em; color: #999">web 安全</a> <a href="/tags/%E5%9C%A8%E8%B7%AF%E4%B8%8A/" style="font-size: 1.1em; color: #999">在路上</a> <a href="/tags/%E5%9F%BA%E7%A1%80/" style="font-size: 1.1em; color: #999">基础</a> <a href="/tags/%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/" style="font-size: 1.1em; color: #999">常用模块</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/" style="font-size: 1.2em; color: #999da3">数据结构和算法</a> <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 1.1em; color: #999">正则表达式</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.1em; color: #999">算法</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 1.1em; color: #999">计算机网络</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">七月 2025</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">十一月 2022</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">十月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><span class="card-archive-list-count">2</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">49</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-07-22T17:12:32.992Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/index.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Legacy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["l am not throwing away my shot!","hey yo, l am just like my country","l am young, scrappy and hungry","and l am not throwing away my shot!"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'l am not throwing away my shot!'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>